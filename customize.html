<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customize Your Sign - 4D Signs</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="customize.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <style>
    /* Size & Quantity Modal */
    #size-qty-modal {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(3px);
        z-index: 2000;
        animation: fadeIn 0.2s ease;
    }
    #size-qty-modal.active { display: flex; }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .size-qty-content {
        background: linear-gradient(145deg, #1e1f26 0%, #2a2b35 100%);
        border-radius: 14px;
        width: 500px;
        max-width: 90%;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.9);
        animation: slideUp 0.3s ease;
        overflow: hidden;
    }
    
    @keyframes slideUp {
        from { transform: translateY(30px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }
    
    .size-qty-body {
        padding: 32px 28px;
    }
    
    .size-row {
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 20px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }
    
    .size-row:last-child {
        border-bottom: none;
    }
    
    .size-header-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .size-label {
        font-size: 1.1rem;
        font-weight: 700;
        color: #FFD700;
    }
    
    .add-color-btn {
        padding: 6px 14px;
        border-radius: 6px;
        background: rgba(255, 215, 0, 0.1);
        border: 1px solid rgba(255, 215, 0, 0.3);
        color: #FFD700;
        font-size: 0.85rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.15s ease;
    }
    
    .add-color-btn:hover {
        background: rgba(255, 215, 0, 0.2);
        border-color: rgba(255, 215, 0, 0.5);
    }
    
    .color-variants {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    
    .color-variant-row {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 8px;
    }
    
    .color-picker-group {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
    }
    
    .color-input {
        width: 45px;
        height: 35px;
        border-radius: 6px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        cursor: pointer;
        background: transparent;
    }
    
    .color-name {
        font-size: 0.9rem;
        color: rgba(230, 230, 230, 0.8);
        font-weight: 500;
    }
    
    .qty-controls {
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    .qty-btn {
        width: 42px;
        height: 42px;
        border-radius: 8px;
        background: linear-gradient(145deg, #2a2b35, #1e1f26);
        border: 2px solid rgba(255, 215, 0, 0.2);
        color: #FFD700;
        font-size: 20px;
        font-weight: 700;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.15s ease;
    }
    
    .qty-btn:hover {
        background: linear-gradient(145deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
        border-color: rgba(255, 215, 0, 0.4);
        transform: scale(1.08);
    }
    
    .qty-btn:active {
        transform: scale(0.95);
    }
    
    .remove-color-btn {
        width: 30px;
        height: 30px;
        border-radius: 6px;
        background: rgba(220, 53, 69, 0.1);
        border: 1px solid rgba(220, 53, 69, 0.3);
        color: #dc3545;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.15s ease;
    }
    
    .remove-color-btn:hover {
        background: rgba(220, 53, 69, 0.2);
        border-color: rgba(220, 53, 69, 0.5);
    }
    
    .qty-value {
        min-width: 50px;
        text-align: center;
        font-size: 1.15rem;
        font-weight: 700;
        color: #fff;
        background: rgba(0, 0, 0, 0.4);
        padding: 8px 14px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .size-qty-footer {
        padding: 20px 28px;
        background: rgba(0, 0, 0, 0.3);
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        display: flex;
        gap: 12px;
        justify-content: flex-end;
    }
    
    .modal-action-btn {
        padding: 12px 28px;
        border-radius: 9px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        border: none;
    }
    
    .cancel-action {
        background: rgba(255, 255, 255, 0.05);
        color: #ccc;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .cancel-action:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
    }
    
    .confirm-action {
        background: linear-gradient(135deg, #FFD700 0%, #FFC107 100%);
        color: #1e1f26;
        box-shadow: 0 4px 16px rgba(255, 215, 0, 0.3);
    }
    
    .confirm-action:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 24px rgba(255, 215, 0, 0.4);
    }
    
    /* Icon Library Styles */
    .icon-library {
        gap: 10px;
        margin-bottom: 12px;
    }
    .icon-btn {
        background: #23243a;
        border: 1px solid #FFD700;
        border-radius: 8px;
        color: #FFD700;
        font-size: 1.3rem;
        padding: 10px 12px;
        cursor: pointer;
        transition: background 0.15s, box-shadow 0.15s;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .icon-btn:hover {
        background: #FFD700;
        color: #23243a;
        box-shadow: 0 4px 16px rgba(255,215,0,0.15);
    }
    #logo-upload {
        background: #23243a;
        color: #FFD700;
        border: 1px solid #FFD700;
        border-radius: 6px;
        padding: 6px 8px;
        margin-top: 4px;
        width: 100%;
    }
    @media (max-width: 640px) {
        .size-qty-content { width: 95%; }
        .size-row { flex-wrap: wrap; gap: 12px; }
        .qty-controls { width: 100%; justify-content: center; }
    }
    .template-img {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.25;
      pointer-events: none;
      z-index: 1;
    }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <a href="/4D-Signs/Homepage.html" class="logo">4D Signs</a>
            <nav class="nav-bar">
                <a href="/4D-Signs/4Dsigns.php" class="nav-link"><i class="fas fa-home"></i> Home</a>
                <a href="/4D-Signs/customize.html" class="nav-link active"><i class="fas fa-palette"></i> Customize</a>
                <a href="/4D-Signs/review.html" class="nav-link"><i class="fas fa-star"></i> <span>Orders/Reviews</span></a>
                <a href="/4D-Signs/cart.html" class="nav-link" title="Cart"><i class="fas fa-shopping-cart"></i></a>
                <a href="/4D-Signs/contact.html" class="nav-link" title="Contact"><i class="fas fa-envelope"></i></a>
            </nav>
        </div>
    </header>

    <main id="customize">
        <div class="page-header">
            <h1><i class="fas fa-paint-brush"></i> Customize Your Product</h1>
            <p class="subtitle">Create your unique design with our easy-to-use customization tool</p>
            <p class="subtitle" style="font-size: 0.75rem; margin-top: 0.5rem; opacity: 0.7;">
                <i class="fas fa-keyboard"></i> Shortcuts: Ctrl+Z (Undo), Ctrl+Y (Redo), Ctrl+D (Duplicate), Del (Delete), Arrows (Move)
            </p>
        </div>

        <div class="custom-layout">
            <form class="customize" enctype="multipart/form-data" autocomplete="off" style="display: contents;">
            <!-- Left Sidebar - Tools Panel -->
            <aside class="tools-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-magic"></i> Design Tools</h3>
                </div>

                <div class="sidebar-content">
                    <!-- Elements Section -->
                    <div class="tool-section">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-shapes"></i>
                            <span>Elements</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <button type="button" id="add-text-btn" class="element-btn">
                                <i class="fas fa-font"></i>
                                <span>Add Text</span>
                            </button>
                            <div class="text-input-wrapper">
                                <input type="text" id="text-input" placeholder="Type your text..." class="custom-input">
                            </div>
                        </div>
                    </div>

                    <!-- Logos Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-icons"></i>
                            <span>Logos</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="icon-library" style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 12px;">
                                <button type="button" class="icon-btn" data-icon="fa-briefcase" title="Business"><i class="fas fa-briefcase"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-building" title="Office"><i class="fas fa-building"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-graduation-cap" title="Education"><i class="fas fa-graduation-cap"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-stethoscope" title="Medical"><i class="fas fa-stethoscope"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-car" title="Automotive"><i class="fas fa-car"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-utensils" title="Restaurant"><i class="fas fa-utensils"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-tshirt" title="Apparel"><i class="fas fa-tshirt"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-dumbbell" title="Fitness"><i class="fas fa-dumbbell"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-tree" title="Nature"><i class="fas fa-tree"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-cogs" title="Industry"><i class="fas fa-cogs"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-bolt" title="Energy"><i class="fas fa-bolt"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-heart" title="Charity"><i class="fas fa-heart"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-music" title="Music"><i class="fas fa-music"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-plane" title="Travel"><i class="fas fa-plane"></i></button>
                                <button type="button" class="icon-btn" data-icon="fa-shopping-cart" title="E-commerce"><i class="fas fa-shopping-cart"></i></button>
                            </div>
                        </div>
                    </div>
                    <!-- End Logos Section -->

                    <!-- Template Color Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-palette"></i>
                            <span>Template Color</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="style-row">
                                <label><i class="fas fa-shirt"></i> Product Background</label>
                                <div class="template-color-grid">
                                    <button type="button" class="template-color-btn" data-color="#FFFFFF" style="background: #FFFFFF;" title="White"></button>
                                    <button type="button" class="template-color-btn" data-color="#000000" style="background: #000000;" title="Black"></button>
                                    <button type="button" class="template-color-btn" data-color="#FF0000" style="background: #FF0000;" title="Red"></button>
                                    <button type="button" class="template-color-btn" data-color="#00FF00" style="background: #00FF00;" title="Green"></button>
                                    <button type="button" class="template-color-btn" data-color="#0000FF" style="background: #0000FF;" title="Blue"></button>
                                    <button type="button" class="template-color-btn" data-color="#FFFF00" style="background: #FFFF00;" title="Yellow"></button>
                                    <button type="button" class="template-color-btn" data-color="#FF00FF" style="background: #FF00FF;" title="Magenta"></button>
                                    <button type="button" class="template-color-btn" data-color="#00FFFF" style="background: #00FFFF;" title="Cyan"></button>
                                    <button type="button" class="template-color-btn" data-color="#FFA500" style="background: #FFA500;" title="Orange"></button>
                                    <button type="button" class="template-color-btn" data-color="#800080" style="background: #800080;" title="Purple"></button>
                                    <button type="button" class="template-color-btn" data-color="#FFC0CB" style="background: #FFC0CB;" title="Pink"></button>
                                    <button type="button" class="template-color-btn" data-color="#808080" style="background: #808080;" title="Gray"></button>
                                </div>
                                <div class="color-input-wrapper" style="margin-top: 12px;">
                                    <input type="color" id="template-color-picker" value="#FFFFFF" class="custom-color">
                                    <span class="color-hex" id="template-color-hex">#FFFFFF</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Text Styles Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-text-height"></i>
                            <span>Text Styles</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="style-row">
                                <label>Font</label>
                                <select id="text-font" class="custom-select">
                                    <option value="Poppins">Poppins</option>
                                    <option value="Arial">Arial</option>
                                    <option value="Georgia">Georgia</option>
                                    <option value="Courier New">Courier New</option>
                                    <option value="Comic Sans MS">Comic Sans</option>
                                    <option value="Impact">Impact</option>
                                </select>
                            </div>
                            <div class="style-row">
                                <label>Size</label>
                                <div class="range-wrapper">
                                    <input type="range" id="text-size" min="12" max="72" value="24" class="custom-slider">
                                    <span id="text-size-value" class="range-label">24</span>
                                </div>
                            </div>
                            <div class="style-row">
                                <label>Weight</label>
                                <select id="text-weight" class="custom-select">
                                    <option value="300">Light</option>
                                    <option value="400">Normal</option>
                                    <option value="600">Semi-Bold</option>
                                    <option value="700" selected>Bold</option>
                                    <option value="900">Black</option>
                                </select>
                            </div>
                            <div class="style-row">
                                <label>Color</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="text-color" value="#FFFFFF" class="custom-color">
                                    <span class="color-hex">#FFFFFF</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Position Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-arrows-alt"></i>
                            <span>Position</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="style-row">
                                <label>Rotation</label>
                                <div class="range-wrapper">
                                    <input type="range" id="rotation-slider" min="0" max="360" value="0" class="custom-slider">
                                    <span id="rotation-value" class="range-label">0°</span>
                                </div>
                            </div>
                            <div class="style-row">
                                <label>Opacity</label>
                                <div class="range-wrapper">
                                    <input type="range" id="opacity-slider" min="0" max="100" value="100" class="custom-slider">
                                    <span id="opacity-value" class="range-label">100%</span>
                                </div>
                            </div>
                            <div class="button-group">
                                <button type="button" id="flip-horizontal" class="mini-btn">
                                    <i class="fas fa-arrows-left-right"></i>
                                    <span>Flip H</span>
                                </button>
                                <button type="button" id="flip-vertical" class="mini-btn">
                                    <i class="fas fa-arrows-up-down"></i>
                                    <span>Flip V</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Effects Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-wand-magic-sparkles"></i>
                            <span>Effects</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="style-row">
                                <label>Brightness</label>
                                <div class="range-wrapper">
                                    <input type="range" id="brightness-slider" min="0" max="200" value="100" class="custom-slider">
                                    <span id="brightness-value" class="range-label">100</span>
                                </div>
                            </div>
                            <div class="style-row">
                                <label>Contrast</label>
                                <div class="range-wrapper">
                                    <input type="range" id="contrast-slider" min="0" max="200" value="100" class="custom-slider">
                                    <span id="contrast-value" class="range-label">100</span>
                                </div>
                            </div>
                            <div class="style-row">
                                <label>Saturation</label>
                                <div class="range-wrapper">
                                    <input type="range" id="saturation-slider" min="0" max="200" value="100" class="custom-slider">
                                    <span id="saturation-value" class="range-label">100</span>
                                </div>
                            </div>
                            <div class="style-row">
                                <label>Blur</label>
                                <div class="range-wrapper">
                                    <input type="range" id="blur-slider" min="0" max="10" value="0" step="0.5" class="custom-slider">
                                    <span id="blur-value" class="range-label">0</span>
                                </div>
                            </div>
                            <button type="button" id="reset-filters" class="reset-btn">
                                <i class="fas fa-rotate-left"></i> Reset All Filters
                            </button>
                        </div>
                    </div>

                    <!-- Layers Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-layer-group"></i>
                            <span>Layers</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="button-group vertical">
                                <button type="button" id="bring-forward" class="layer-action-btn">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>Bring Forward</span>
                                </button>
                                <button type="button" id="send-backward" class="layer-action-btn">
                                    <i class="fas fa-arrow-down"></i>
                                    <span>Send Backward</span>
                                </button>
                                <button type="button" id="duplicate-btn" class="layer-action-btn">
                                    <i class="fas fa-copy"></i>
                                    <span>Duplicate (Ctrl+D)</span>
                                </button>
                                <button type="button" id="delete-selected" class="layer-action-btn delete">
                                    <i class="fas fa-trash-alt"></i>
                                    <span>Delete Selected</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- History Section -->
                    <div class="tool-section collapsed">
                        <button type="button" class="section-btn" onclick="toggleSection(this)">
                            <i class="fas fa-history"></i>
                            <span>History</span>
                            <i class="fas fa-chevron-down arrow"></i>
                        </button>
                        <div class="section-content">
                            <div class="button-group vertical">
                                <button type="button" id="undo-btn" class="layer-action-btn">
                                    <i class="fas fa-undo"></i>
                                    <span>Undo (Ctrl+Z)</span>
                                </button>
                                <button type="button" id="redo-btn" class="layer-action-btn">
                                    <i class="fas fa-redo"></i>
                                    <span>Redo (Ctrl+Y)</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Custom Area -->
            <div class="custom-area">
                <div class="custom-container">
                    <!-- Selection Info Banner -->
                    <div id="selection-info" style="display: none; background: rgba(255, 215, 0, 0.2); border: 1px solid #FFD700; padding: 0.5rem 1rem; margin-bottom: 1rem; border-radius: 8px; text-align: center; color: #FFD700; font-size: 0.9rem;">
                        <i class="fas fa-check-circle"></i> No element selected
                    </div>

                    <div class="product-selector-bar">
                        <label for="product-type"><i class="fas fa-box-open"></i> Product Type</label>
                        <select class="custom-select-dropdown" id="product-type">
                         <!--   <option value="sign">Custom Sign</option> -->
                            <option value="shirt">T-Shirt</option>
                            <option value="mug">Mug</option>
                            <option value="ecobag">Eco Bag</option>
                            <option value="key-chain">Key Chain</option>
                            <option value="ref-magnet">Ref Magnet</option>
                            <option value="sticker">Sticker</option>
                        </select>
                    </div>
                    <div class="design-canvas">
                        <div class="shirt-drop-area" id="shirtDropArea"> 
                            <div class="design-area">
                                <img id="sign-image"
                                     src="LogoProducts/sign-outline.jpg"
                                     alt="Sign Preview" 
                                     class="sign-preview product-template-image" 
                                     style="display:none; width:100%; height:auto; max-width:720px; margin:0 auto; pointer-events:none; user-select:none;"
                                     draggable="false"/>
                                <img id="shirt-image"
                                     src="LogoProducts/shirt-outline.jpg"
                                     alt="T-Shirt Preview" 
                                     class="shirt-preview product-template-image" 
                                     style="display:block; width:200%; height:auto; max-width:none; margin:0 auto; pointer-events:none; user-select:none; object-fit:contain;"
                                     draggable="false"/>
                                <img id="mug-image"
                                     src="LogoProducts/mug-outline.jpg"
                                     alt="Mug Preview" 
                                     class="mug-preview product-template-image" 
                                     style="display:none; width:100%; height:auto; max-width:720px; margin:0 auto; pointer-events:none; user-select:none;"
                                     draggable="false"/>
                                <img id="ecobag-image"
                                     src="LogoProducts/ecobag-outline.jpg"
                                     alt="Eco Bag Preview" 
                                     class="ecobag-preview product-template-image" 
                                     style="display:none; width:100%; height:auto; max-width:720px; margin:0 auto; pointer-events:none; user-select:none;"
                                     draggable="false"/>
                                <img id="key-chain-image"
                                     src="LogoProducts/key-chain-outline.jpg"
                                     alt="Key Chain Preview" 
                                     class="key-chain-preview product-template-image" 
                                     style="display:none; width:100%; height:auto; max-width:720px; margin:0 auto; pointer-events:none; user-select:none;"
                                     draggable="false"/>
                                <img id="ref-magnet-image"
                                     src="LogoProducts/ref-magnet-outline.jpg"
                                     alt="Ref Magnet Preview" 
                                     class="ref-magnet-preview product-template-image" 
                                     style="display:none; width:100%; height:auto; max-width:720px; margin:0 auto; pointer-events:none; user-select:none;"
                                     draggable="false"/>
                                <img id="sticker-image"
                                     src="LogoProducts/sticker-outline.jpg"
                                     alt="Sticker Preview" 
                                     class="sticker-preview product-template-image" 
                                     style="display:none; width:100%; height:auto; max-width:720px; margin:0 auto; pointer-events:none; user-select:none;"
                                     draggable="false"/>
                                <img id="shirt-template" src="ProductPics/shirt-template.png" class="template-img" style="display: none;">
                                <img id="mug-template" src="ProductPics/mug-template.png" class="template-img" style="display: none;">
                                <img id="sign-template" src="ProductPics/sign-template.png" class="template-img" style="display: none;">
                                <p class="hint-text"><i class="fas fa-info-circle"></i> Drag and drop your design here</p>
                            </div>
                        </div>
                    </div>
                    <div class="custom-footer">
                        <button type="button" id="choose-again" class="secondary-action-btn" style="display: none;">
                            <i class="fas fa-redo"></i> Choose Again
                        </button>
                        <button type="button" id="clear-all-btn" class="secondary-action-btn" style="background: rgba(220, 53, 69, 0.2); border-color: #dc3545;">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                        <button type="button" id="done-design-btn" class="primary-action-btn">
                            <i class="fas fa-check-circle"></i> Done Design
                        </button>
                    </div>
                </div>
            </div>

            <!-- Size & Quantity Modal -->
            <div id="size-qty-modal">
                <div class="size-qty-content">
                    <div class="size-qty-body">
                        <!-- Small -->
                        <div class="size-row">
                            <div class="size-header-row">
                                <div class="size-label">Small (S)</div>
                                <button type="button" class="add-color-btn" onclick="addColorVariant('small')">
                                    <i class="fas fa-plus"></i> Add Color
                                </button>
                            </div>
                            <div class="color-variants" id="small-variants"></div>
                        </div>
                        <!-- Medium -->
                        <div class="size-row">
                            <div class="size-header-row">
                                <div class="size-label">Medium (M)</div>
                                <button type="button" class="add-color-btn" onclick="addColorVariant('medium')">
                                    <i class="fas fa-plus"></i> Add Color
                                </button>
                            </div>
                            <div class="color-variants" id="medium-variants"></div>
                        </div>
                        <!-- Large -->
                        <div class="size-row">
                            <div class="size-header-row">
                                <div class="size-label">Large (L)</div>
                                <button type="button" class="add-color-btn" onclick="addColorVariant('large')">
                                    <i class="fas fa-plus"></i> Add Color
                                </button>
                            </div>
                            <div class="color-variants" id="large-variants"></div>
                        </div>
                    </div>
                    <div class="size-qty-footer">
                        <button type="button" class="modal-action-btn cancel-action" onclick="closeSizeQtyModal()">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button type="button" class="modal-action-btn confirm-action" onclick="confirmAddToCart()">
                            <i class="fas fa-check"></i> Add to Cart
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Upload -->
            <aside class="upload-panel">
                <div class="upload-header">
                    <h3><i class="fas fa-cloud-upload-alt"></i> Upload Your Design</h3>
                </div>
                <div class="upload-panel-content">
                    <!-- Image Upload Area -->
                    <div class="add-image" id="upload-area">
                        <div class="upload-container">
                            <div class="upload-icon"><i class="fas fa-image"></i></div>
                            <p id="drop-text">Drag & drop your image here</p>
                            <p class="or-text">or</p>
                            <button type="button" class="browse-btn" onclick="document.getElementById('image-upload').click()">
                                <i class="fas fa-folder-open"></i> Browse
                            </button>
                            <input type="file" id="image-upload" accept="image/*" style="display: none;">
                            <img id="preview-image" class="preview-image" style="display: none;">
                        </div>
                    </div>

                    <!-- Custom Name Input -->
                    <div class="custom-name">
                        <label for="custom-text"><i class="fas fa-heading"></i> Product Name</label>
                        <input type="text" id="custom-text" placeholder="e.g., My Awesome Shirt">
                    </div>

                    <!-- Icons/Shapes Library -->
                    <div class="form-section">
                        <h3><i class="fas fa-icons"></i> Add Icons</h3>
                        <div class="icon-library">
                            <button type="button" class="icon-btn" data-icon="fa-heart" title="Heart"><i class="fas fa-heart"></i></button>
                            <button type="button" class="icon-btn" data-icon="fa-star" title="Star"><i class="fas fa-star"></i></button>
                            <button type="button" class="icon-btn" data-icon="fa-circle" title="Circle"><i class="fas fa-circle"></i></button>
                            <button type="button" class="icon-btn" data-icon="fa-square" title="Square"><i class="fas fa-square"></i></button>
                        </div>
                    </div>

                    <!-- Logo Upload -->
                    <div class="form-section">
                        <h3><i class="fas fa-image"></i> Upload Logo</h3>
                        <input type="file" id="logo-upload" accept="image/*" style="display: none;">
                        <button type="button" class="browse-btn" onclick="document.getElementById('logo-upload').click()">
                            <i class="fas fa-upload"></i> Upload Logo
                        </button>
                    </div>

                    <!-- Done Design Button -->
                    <button type="button" id="done-design-btn" class="submit-btn" style="width: 100%; margin-top: 2rem;">
                        <i class="fas fa-check"></i> Done - Choose Size & Quantity
                    </button>
                </div>
            </aside>
            </form>
        </div>
    </main>

    <script>
        // Size & Quantity Modal Functions
        let colorVariantCounter = 0;
        
        function addColorVariant(size) {
            const variantsContainer = document.getElementById(`${size}-variants`);
            const variantId = `variant-${size}-${colorVariantCounter++}`;
            
            const variantRow = document.createElement('div');
            variantRow.className = 'color-variant-row';
            variantRow.id = variantId;
            variantRow.innerHTML = `
                <div class="color-picker-group">
                    <input type="color" class="color-input" value="#ffffff" onchange="updateColorName(this)">
                    <span class="color-name">#FFFFFF</span>
                </div>
                <div class="qty-controls">
                    <button type="button" class="qty-btn" onclick="adjustVariantQty('${variantId}', -1)">−</button>
                    <div class="qty-value" data-qty="1">1</div>
                    <button type="button" class="qty-btn" onclick="adjustVariantQty('${variantId}', 1)">+</button>
                </div>
                <button type="button" class="remove-color-btn" onclick="removeColorVariant('${variantId}')">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            variantsContainer.appendChild(variantRow);
        }
        
        function updateColorName(input) {
            const colorName = input.nextElementSibling;
            colorName.textContent = input.value.toUpperCase();
        }
        
        function adjustVariantQty(variantId, delta) {
            const variant = document.getElementById(variantId);
            const qtyEl = variant.querySelector('.qty-value');
            let currentQty = parseInt(qtyEl.dataset.qty);
            currentQty = Math.max(1, currentQty + delta);
            qtyEl.dataset.qty = currentQty;
            qtyEl.textContent = currentQty;
        }
        
        function removeColorVariant(variantId) {
            document.getElementById(variantId).remove();
        }
        
        function closeSizeQtyModal() {
            document.getElementById('size-qty-modal').classList.remove('active');
            // Clear all variants
            document.getElementById('small-variants').innerHTML = '';
            document.getElementById('medium-variants').innerHTML = '';
            document.getElementById('large-variants').innerHTML = '';
            colorVariantCounter = 0;
        }
        
        function confirmAddToCart() {
            const items = [];
            
            ['small', 'medium', 'large'].forEach(size => {
                const variantsContainer = document.getElementById(`${size}-variants`);
                const variants = variantsContainer.querySelectorAll('.color-variant-row');
                
                variants.forEach(variant => {
                    const color = variant.querySelector('.color-input').value;
                    const qty = parseInt(variant.querySelector('.qty-value').dataset.qty);
                    
                    items.push({
                        size: size.charAt(0).toUpperCase() + size.slice(1),
                        color: color,
                        quantity: qty
                    });
                });
            });
            
            if (items.length === 0) {
                alert('Please add at least one color variant');
                return;
            }
            
            // Get product info
            const productType = document.getElementById('product-type')?.value || 'custom';
            const productName = document.getElementById('custom-text')?.value || 'Custom Product';
            
            // Get existing cart items
            let cartItems = [];
            try {
                cartItems = JSON.parse(localStorage.getItem('cartItems') || '[]');
            } catch(e) {
                cartItems = [];
            }
            
            // Add each color variant as separate cart item
            items.forEach(variant => {
                const cartItem = {
                    id: Date.now() + Math.random(),
                    name: productName,
                    category: productType,
                    size: variant.size,
                    color: variant.color,
                    qty: variant.quantity,
                    price: 150, // Default price
                    image: 'BGDS.jpg', // Default image
                    isCustom: true
                };
                
                cartItems.push(cartItem);
            });
            
            // Save to localStorage
            localStorage.setItem('cartItems', JSON.stringify(cartItems));
            
            // Update cart count
            const totalQty = cartItems.reduce((sum, item) => sum + (parseInt(item.qty) || 0), 0);
            localStorage.setItem('cartCount', String(totalQty));
            
            // Trigger cart update event
            window.dispatchEvent(new CustomEvent('cart:updated', { 
                detail: { count: totalQty, items: cartItems } 
            }));
            
            closeSizeQtyModal();
            
            // Redirect to cart page
            window.location.href = 'cart.html';
        }
        
        function toggleSection(button) {
            const section = button.closest('.tool-section');
            const content = section.querySelector('.section-content');
            const arrow = button.querySelector('.arrow');
            
            section.classList.toggle('collapsed');
            
            if (section.classList.contains('collapsed')) {
                content.style.maxHeight = '0';
                content.style.opacity = '0';
                arrow.style.transform = 'rotate(-90deg)';
            } else {
                content.style.maxHeight = content.scrollHeight + 'px';
                content.style.opacity = '1';
                arrow.style.transform = 'rotate(0deg)';
            }
        }
        
        // Initialize all sections as collapsed on page load
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.tool-section.collapsed');
            sections.forEach(section => {
                const content = section.querySelector('.section-content');
                const arrow = section.querySelector('.arrow');
                if (content) {
                    content.style.maxHeight = '0';
                    content.style.opacity = '0';
                }
                if (arrow) {
                    arrow.style.transform = 'rotate(-90deg)';
                }
            });
        });

        // All event listeners are now handled in customize-script.js to avoid duplication
        // This includes: slider updates, color pickers, template switching, etc.
    </script>
    <script src="customize-script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('✓ Customize page initialized');

            const productType = document.getElementById('product-type');
            
            if (productType) {
                productType.addEventListener('change', updateProductDisplay);
                updateProductDisplay(); // This will show the default selected product
            }

            function updateProductDisplay() {
                const selectedType = productType.value;
                console.log('✓ Product type changed to:', selectedType);

                // Hide ALL product images
                const allImages = document.querySelectorAll('.product-template-image');
                allImages.forEach(img => img.style.display = 'none');

                // Show ONLY the selected product
                const imageMap = {
                    'shirt': 'shirt-image',
                    'mug': 'mug-image',
                    'ecobag': 'ecobag-image',
                    'key-chain': 'key-chain-image',
                    'ref-magnet': 'ref-magnet-image',
                    'sticker': 'sticker-image'
                };

                const imageId = imageMap[selectedType];
                if (imageId) {
                    const img = document.getElementById(imageId);
                    if (img) img.style.display = 'block';
                }
            }
        });
    </script>
</body>
</html>
